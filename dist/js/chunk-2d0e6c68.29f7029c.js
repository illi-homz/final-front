(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e6c68"],{"99d6":function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"edit-test"},[e("b-row",{staticClass:"mt-2"},[e("b-col",{staticClass:"mx-auto",attrs:{cols:"11",xl:"9"}},[t.success?e("h1",{staticClass:"text-center text-success"},[t._v(" ИЗМЕНЕНИЯ ВНЕСЕНЫ ")]):t._e(),t.test?e("b-jumbotron",{staticClass:"w-100 mx-auto py-3",attrs:{"bg-variant":"info","border-variant":"dark"}},[e("b-form",{ref:"form"},[e("b-row",{staticClass:"mb-1"},[e("b-col",{attrs:{cols:"3"}},[t._v(" Название теста ")]),e("b-col",[e("b-input",{attrs:{placeholder:"Введите название теста"},model:{value:t.test.title,callback:function(s){t.$set(t.test,"title",s)},expression:"test.title"}}),t.error?e("p",{staticClass:"my-0"},[e("em",{staticClass:"text-light"},[t._v("* Введите название теста")])]):t._e()],1)],1),e("b-row",{staticClass:"mb-1"},[e("b-col",{attrs:{cols:"3"}},[t._v(" О тесте ")]),e("b-col",[e("b-form-textarea",{attrs:{placeholder:"Введите описание",rows:"1"},model:{value:t.test.about,callback:function(s){t.$set(t.test,"about",s)},expression:"test.about"}}),t.error?e("p",{staticClass:"my-0"},[e("em",{staticClass:"text-light"},[t._v("* Введите описание теста")])]):t._e()],1)],1),e("b-row",{staticClass:"mb-1"},[e("b-col",{attrs:{cols:"3"}},[t._v(" Дата начала ")]),e("b-col",[e("b-form-datepicker",{attrs:{placeholder:"Выберите дату начала тестирования"},model:{value:t.test.start_date,callback:function(s){t.$set(t.test,"start_date",s)},expression:"test.start_date"}}),t.error?e("p",{staticClass:"my-0"},[e("em",{staticClass:"text-light"},[t._v("* Введите дату начала тестирования")])]):t._e()],1)],1),e("b-row",{staticClass:"mb-1"},[e("b-col",{attrs:{cols:"3"}},[t._v(" Дата окончания ")]),e("b-col",[e("b-form-datepicker",{attrs:{placeholder:"Выберите дату окончания тестирования"},model:{value:t.test.end_date,callback:function(s){t.$set(t.test,"end_date",s)},expression:"test.end_date"}}),t.error?e("p",{staticClass:"my-0"},[e("em",{staticClass:"text-light"},[t._v("* Введите дату окончания тестирования")])]):t._e(),t.dateError?e("p",{staticClass:"my-0"},[e("em",{staticClass:"text-light"},[t._v("* Дата окончания должна быть после даты начала")])]):t._e()],1)],1),e("b-row",{staticClass:"mb-1"},[e("b-col",{attrs:{cols:"3"}},[t._v(" Время на вопрос, сек ")]),e("b-col",[e("b-form-input",{attrs:{type:"number",placeholder:"Введите число"},model:{value:t.test.time_on_question,callback:function(s){t.$set(t.test,"time_on_question",s)},expression:"test.time_on_question"}}),t.error?e("p",{staticClass:"my-0"},[e("em",{staticClass:"text-light"},[t._v("* Введите время на вопрос")])]):t._e()],1)],1),e("b-row",{staticClass:"mb-1"},[e("b-col",{attrs:{cols:"3"}},[t._v(" Тестируемые "),e("br"),e("em",{staticStyle:{"font-size":"8pt"}},[t._v(" (Выберите удерживая CTRL) ")])]),e("b-col",[e("b-form-select",{attrs:{options:t.users,multiple:"","select-size":4},model:{value:t.selectedUsers,callback:function(s){t.selectedUsers=s},expression:"selectedUsers"}}),t.error?e("p",{staticClass:"my-0"},[e("em",{staticClass:"text-light"},[t._v("* Выберите пользователей")])]):t._e()],1)],1),e("b-row",{staticClass:"mb-1 my-2",attrs:{"align-v":"center"}},[e("b-col",{attrs:{cols:"3"}},[t._v(" Изображение ")]),e("b-col",[t.test.img?e("b-row",[e("b-col",[e("b-link",{attrs:{href:""+t.test.img}},[e("b-button",{attrs:{variant:"outline-light"}},[e("b",[t._v(t._s(t.test.img))])])],1)],1)],1):t._e(),e("b-row",{staticClass:"mt-2"},[e("b-col",[e("b-form-file",{attrs:{plain:""},model:{value:t.image,callback:function(s){t.image=s},expression:"image"}})],1)],1)],1)],1),e("b-row",{staticClass:"mb-1"},[e("b-col",{attrs:{cols:"3"}},[e("p",{staticClass:"mb-0"},[t._v("Вопросы")])]),e("b-col",[e("h6",{staticClass:"text-center"},[t._v(" Всего баллов за тест: "+t._s(t.countTotalPrice)+" ")]),t.test.questions?e("b-row",[e("b-col",t._l(t.test.questions,(function(s,a){return e("b-row",{key:a},[e("b-col",[e("b-row",{attrs:{"align-v":"center"}},[e("b-col",{staticClass:"pr-0"},[e("p",[t._v("Вопрос "+t._s(a+1)+". "+t._s(s.question.question))])]),e("b-col",{staticClass:"pl-1",attrs:{cols:"3"}},[e("p",[t._v("Баллов за вопрос: "+t._s(s.price))])])],1)],1)],1)})),1)],1):t._e(),t.test.groups?e("b-row",[e("b-col",t._l(t.test.groups,(function(s,a){return e("b-row",{key:a},[e("b-col",t._l(s.group.questions,(function(o,i){return e("b-row",{key:i},[e("b-col",[e("b-row",{attrs:{"align-v":"center"}},[e("b-col",{staticClass:"pr-0"},[e("p",[t._v("Группа "+t._s(a+1)+". Вопрос "+t._s(i+1)+". "+t._s(o.question))])]),e("b-col",{staticClass:"pl-1",attrs:{cols:"3"}},[e("p",[t._v("Баллов за вопрос: "+t._s(s.price))])])],1)],1)],1)})),1)],1)})),1)],1):t._e(),e("b-row",{staticClass:"mt-2 mx-0"},[e("b-button",{staticClass:"ml-auto",attrs:{variant:"danger"},on:{click:t.putchTest}},[t._v(" Отправить изменения ")])],1)],1)],1)],1)],1):e("p",[t._v("Loading ...")])],1)],1)],1)},o=[],i=(e("99af"),e("ac1f"),e("5319"),e("bc3a")),r=e.n(i),c="https://testing-gomza-back.herokuapp.com",l={name:"EditTest",data:function(){return{test:"",selectedUsers:[],users:[],totalPrice:0,image:null,error:0,dateError:0,success:0}},methods:{setConfig:function(){var t=this.$cookies.get("jwt_token"),s={headers:{"X-CSRFToken":this.$cookies.get("csrftoken"),Authorization:"Bearer ".concat(t)}};return s},getTest:function(){var t=this,s=this.setConfig(),e="".concat(this.$route.params.id);r.a.get("".concat(c,"/tests/").concat(e,"/"),s).then((function(s){t.test=s.data;for(var e=0;e<t.test.tested_users.length;e+=1)t.selectedUsers.push(t.test.tested_users[e].id)}))},getUsers:function(){var t=this,s=this.setConfig();r.a.get("".concat(c,"/users/"),s).then((function(s){for(var e=0;e<s.data.length;e+=1)t.users.push({value:s.data[e].id,text:s.data[e].username})}))},putchTest:function(){var t=this;if(this.test.title&&this.test.about&&this.test.start_date&&this.test.end_date&&this.test.time_on_question){var s=new Date(this.test.start_date),e=new Date(this.test.end_date);if(!(s>e)){var a=this.setConfig(),o={id:this.test.id,title:this.test.title,about:this.test.about,start_date:this.test.start_date,end_date:this.test.end_date,time_on_question:this.test.time_on_question,img:this.test.img,tested_users:this.selectedUsers,questions:[],groups:[]};if(this.test.questions.length>0)for(var i=0;i<this.test.questions.length;i+=1){var l=this.test.questions[i].id;o.questions.push(l)}else if(this.test.groups.length>0)for(var n=0;n<this.test.groups.length;n+=1){var u=this.test.groups[n].id;o.groups.push(u)}if(this.image){var b=this.setConfig();b.headers["Content-Type"]="multipart/form-data";var h=new FormData;h.append("file",this.image),r.a.post("".concat(c,"/images/"),h,b).then((function(s){o.img=s.data.file,r.a.patch("".concat(c,"/tests/").concat(o.id,"/"),o,a).then((function(){t.success=1,setTimeout((function(){t.success=0,t.$router.replace("/test-details/".concat(t.test.id))}),1e3)}))}))}else r.a.patch("".concat(c,"/tests/").concat(o.id,"/"),o,a).then((function(){t.success=1,setTimeout((function(){t.success=0,t.$router.replace("/test-details/".concat(t.test.id))}),1e3)}));return"Hello"}this.dateError=1}else this.error=1}},computed:{countTotalPrice:function(){for(var t=0,s=0;s<this.test.questions.length;s+=1)t+=this.test.questions[s].price;for(var e=0;e<this.test.groups.length;e+=1){var a=this.test.groups[e].group.questions.length;t+=this.test.groups[e].price*a}return t}},mounted:function(){this.getTest(),this.getUsers()}},n=l,u=e("2877"),b=Object(u["a"])(n,a,o,!1,null,null,null);s["default"]=b.exports}}]);
//# sourceMappingURL=chunk-2d0e6c68.29f7029c.js.map